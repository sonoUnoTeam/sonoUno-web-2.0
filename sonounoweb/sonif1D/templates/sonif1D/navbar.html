 <!-- BARRA DE NAVEGACIÓN -->
 <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="{% url 'inicio' %}">
            <h3>sonoUno web</h3>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <!-- Botones de la barra de navegación -->
                <div class="btn-group" role="group">
                    <button id="btnGroupDrop1" type="button" class="btn btn-dark dropdown-toggle text-white navbar-dropdown-btn" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-file-import me-2"></i>Importar
                    </button>
                    <ul class="dropdown-menu navbar-dropdown-menu" aria-labelledby="btnGroupDrop1">
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:importar_archivo' %}">
                            <i class="fas fa-file-csv me-2"></i>Archivo csv/txt
                        </a></li>
                         <!-- <li><a class="dropdown-item navbar-dropdown-item" href="">
                            <i class="fas fa-file-audio me-2"></i>Archivo .WAV
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="">
                            <i class="fas fa-map-marker-alt me-2"></i>Marcadores .CSV
                        </a></li>  -->
                    </ul>
                </div>
                <div class="btn-group" role="group">
                    <button id="btnGroupDrop2" type="button" class="btn btn-dark dropdown-toggle text-white navbar-dropdown-btn" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-download me-2"></i>Exportar
                    </button>
                    <ul class="dropdown-menu navbar-dropdown-menu" aria-labelledby="btnGroupDrop2">
                        <li><a class="dropdown-item navbar-dropdown-item" href="#" id="downloadImage">
                            <i class="fas fa-chart-line me-2"></i>Gráfico
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="#" id="downloadAudio">
                            <i class="fas fa-volume-up me-2"></i>Sonido
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="#" id="downloadMarkers">
                            <i class="fas fa-bookmark me-2"></i>Marcadores
                        </a></li>
                    </ul>                    
                </div>
                <div class="btn-group" role="group">
                    <button id="btnGroupDrop3" type="button" class="btn btn-dark dropdown-toggle text-white navbar-dropdown-btn" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-database me-2"></i>Datos
                    </button>
                    <ul class="dropdown-menu navbar-dropdown-menu" aria-labelledby="btnGroupDrop3">
                        <li><h6 class="dropdown-header"><i class="fas fa-shapes me-2"></i>Formas Básicas</h6></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'sinusoidal.txt' %}">
                            <i class="fas fa-wave-square me-2"></i>Sinusoidal
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'square.txt' %}">
                            <i class="fas fa-square me-2"></i>Square Wave
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'triangular.txt' %}">
                            <i class="fas fa-play me-2"></i>Triangular
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'sawtooth.txt' %}">
                            <i class="fas fa-chart-line me-2"></i>Sawtooth
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header"><i class="fas fa-chart-area me-2"></i>Tendencias</h6></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'growing.txt' %}">
                            <i class="fas fa-arrow-up me-2"></i>Growing
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'decrease.txt' %}">
                            <i class="fas fa-arrow-down me-2"></i>Decrease
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'step.txt' %}">
                            <i class="fas fa-stairs me-2"></i>Step Function
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header"><i class="fas fa-atom me-2"></i>Fenómenos Físicos</h6></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'damped.txt' %}">
                            <i class="fas fa-water me-2"></i>Damped Oscillation
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'beats.txt' %}">
                            <i class="fas fa-signal me-2"></i>Beats
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'wave_packet.txt' %}">
                            <i class="fas fa-waveform-path me-2"></i>Wave Packet
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><h6 class="dropdown-header"><i class="fas fa-music me-2"></i>Señales Especiales</h6></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'chirp.txt' %}">
                            <i class="fas fa-broadcast-tower me-2"></i>Chirp (Radar)
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'pulse.txt' %}">
                            <i class="fas fa-heartbeat me-2"></i>Pulse Train
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'harmonic.txt' %}">
                            <i class="fas fa-guitar me-2"></i>Harmonic Series
                        </a></li>
                        <li><a class="dropdown-item navbar-dropdown-item" href="{% url 'sonif1D:mostrar_grafico' 'glitch.txt' %}">
                            <i class="fas fa-bolt me-2"></i>Glitch / Noise
                        </a></li>
                    </ul>
                </div>                    
                <li class="nav-item">
                    <a class="btn btn-dark text-white navbar-help-btn" href="{% url 'sonif1D:ayuda' %}">
                        <i class="fas fa-question-circle me-2"></i>Ayuda
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Script para descargar la imagen y el audio -->
    <script>
        document.getElementById('downloadImage').addEventListener('click', function(event) {
            event.preventDefault();
            // Obtener la cadena base64 de la imagen desde localStorage
            var graficoBase64 = localStorage.getItem('grafico_base64');
            if (graficoBase64) {
                // Crear un enlace de descarga
                var link = document.createElement('a'); // Crear un enlace de descarga
                link.href = 'data:image/png;base64,' + graficoBase64; 
                link.download = 'grafico.png';
                link.click();
            } else {
                alert('No se encontró una imagen disponible.');
            }
        });
    
        document.getElementById('downloadAudio').addEventListener('click', function(event) {
            event.preventDefault();
            // Obtener la cadena base64 del audio desde localStorage
            var audioBase64 = localStorage.getItem('audio_base64');
            if (audioBase64) {
                // Crear un enlace de descarga
                var link = document.createElement('a'); // Crear un enlace de descarga
                link.href = 'data:audio/wav;base64,' + audioBase64;
                link.download = 'audio.wav';
                link.click();
            } else {
                alert('No se encontró un audio disponible.');
            }
        });
        
        document.getElementById('downloadMarkers').addEventListener('click', function(event) {
            event.preventDefault();
            // Obtener los marcadores desde localStorage
            var markersJson = localStorage.getItem('markers');
            if (markersJson) {
                var markers = JSON.parse(markersJson);
                if (markers.length === 0) {
                    alert('No hay marcadores para exportar.');
                    return;
                }
                
                // Crear CSV
                var csvContent = "data:text/csv;charset=utf-8,";
                csvContent += "Index,X,Y\n";
                
                markers.forEach(function(marker) {
                    csvContent += marker.index + "," + marker.x + "," + marker.y + "\n";
                });
                
                // Crear un enlace temporal y descargarlo
                var encodedUri = encodeURI(csvContent);
                var link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "marcadores.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('No hay marcadores para exportar.');
            }
        });
    </script>
</nav>